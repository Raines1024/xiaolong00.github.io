---
layout: post
title: Base64介绍
description: Base64介绍及Java实现
category: blog
date: 2020-01-07 13:50:39
---

## 回顾

### ASCII编码
ASCII编码，从A-Z、a-z、0-9和一些其他的特殊字符，这些字符都有唯一的一个数字来表示。比如说a是97，A是65。

## Base是什么
Base64是一种用64个字符来表示任意二进制数据的方法。

## Base64原理

### Base64编码
Base64编码，范围是”A-Z“、”a-z“、”0-9“、”+“、”/“一共64个字符（0-63）。这个比ASCII编码要简单多了，只有64个。

### Base64基本原理
首先，准备一个包含64个字符的数组： 
 
    ['A', 'B', 'C', ... 'a', 'b', 'c', ... '0', '1', ... '+', '/']

然后，对二进制数据进行处理，每3个字节一组，一共是3x8=24bit，划为4组，每组正好6个bit：  
这样我们得到4个数字作为索引，然后查表，获得相应的4个字符，就是编码后的字符串。   
所以，Base64编码会把3字节的二进制数据编码为4字节的文本数据，长度增加33%，好处是编码后的文本数据可以在邮件正文、网页等直接显示。  
如果要编码的二进制数据不是3的倍数，最后会剩下1个或2个字节怎么办？Base64用\x00字节在末尾补足后，再在编码的末尾加上1个或2个=号，表示补了多少字节，解码的时候，会自动去掉。  

### 实战：ASCII编码转Base64

#### 实例
比如说有一封邮件，我们想要对其使用Base64进行编码。怎么办呢？基本步骤如下：  
（1）对邮件的数据进行切分，每三个字节一组，一共24个bit。  
（2）对切分后的数据重组，24个bit重组为4组，每组6个bit。  
（3）对重组后的数据处理，每组最前面添加两个“0”，构成每组8个bit。此时一共32个bit。  
（4）根据Base64编码表，获取相应的编码值。  
此时一封完整的邮件，被切分重组处理之后就变成了Base64编码了。  

#### 实例验证
比如说电子邮件里面出现了三个字母sky。我们要对这个三个字符使用Base64进行编码。  
（1）对邮件的数据进行切分，每三个字节一组，一共24个bit  
```
数据          s            k       y
ASCII编码     115         107     121
二进制        01110011  01101011  01111001
```
    
（2）对切分后的数据重组，24个bit重组为4组，每组6个bit  
原二进制
```
01110011  01101011  01111001
```
转换后（将三组切分为4组）
```
011100  110110  101101  111001
```
（3）对重组后的数据处理，每组最前面添加两个“0”，构成每组8个bit。由于在最前面添加的0，所以对数值不构成影响。  
（4）根据Base64编码表，获取相应的编码值。  
转换后二进制  
```
011100  110110  101101  111001
```
相应的编码值(二进制转十进制）  
```
0 16 8 4 0 0 ; 32 16 0 4 2 0 ; 32 0 8 4 0 1 ; 32 16 8 0 0 1 
    28              54               45              57
```
（5）完成编码的转换  
根据相应编码值对照Base64编码表
```
    28              54               45              57
    c               2                t               5
```

到这我们基本上就是实现了Base64编码机制从sky到c2t5的转换。

#### 总结
（1）在第三步中，最前面添加了两个0，所以最终编码之后要比之前多出三分之一的大小。  
（2）上面的例子中，我们使用的是ASCII编码，但是如果我们使用UTF-8，对应Base64编码的结果是不一样的。   
（3）Base64只是进行了编码，方便数据的传输而已。Base64具有不可读性，即所编码的数据不会被人用肉眼所直接看到。这可不是加密。  

### Java代码实现(java的base64与byte[]字节数组之间的相互转换)
```
import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;

import java.io.IOException;

public class Base64_ByteTest {
    public static void main(String args[]) throws IOException {
        /**
         * 编码
         */
        // 定义一个BASE64Encoder
        BASE64Encoder encode = new BASE64Encoder();
        // 将byte[]转换为base64
        String base64 = encode.encode("五笔字型电子计算机".getBytes());
        // 输出base64
        System.out.println(base64);

        /**
         * 解码
         */
        // 新建一个BASE64Decoder
        BASE64Decoder decode = new BASE64Decoder();
        // 将base64转换为byte[]
        byte[] b = decode.decodeBuffer(base64);
        // 输出转换后的byte[]
        System.out.println(new String(b));
    }
}
```




































































